# Azure QR Code Generator using Terraform

This project demonstrates how to **provision Azure infrastructure using Terraform** and **deploy a Node.js-based Azure Function App** that generates QR codes and stores them in an Azure Storage Account.

---

## ğŸ“Œ Architecture Overview

Terraform provisions the following Azure resources:

* **Resource Group**: `dubbakas_rg`
* **Storage Account**: `dubbakasstorageaccount`
* **App Service Plan**: `example-app-service-plan` (Linux)
* **Linux Function App**: `harish-function-qr`

The Function App hosts a **QR Code Generator** built with Node.js. When triggered via HTTP, it generates a QR code and stores it in the Azure Storage Account.

---

## ğŸš€ Step 1: Provision Infrastructure with Terraform

From your Terraform project directory, run:

```bash
terraform init
terraform plan
terraform apply
```

### What happens here?

* `terraform init` â†’ Initializes providers and modules
* `terraform plan` â†’ Shows what resources will be created
* `terraform apply` â†’ Creates Azure infrastructure

After successful execution, all required Azure resources will be available.

---

## ğŸ§© Step 2: Prepare the Azure Function Code

Clone the sample QR Code generator application:

```bash
git clone https://github.com/rishabkumar7/azure-qr-code.git
cd azure-qr-code/qrCodeGenerator
```

### Update `local.settings.json`

This file is used **only for local development**.

Replace the storage connection string with the one created by Terraform:

```json
{
  "IsEncrypted": false,
  "Values": {
    "AzureWebJobsStorage": "<your-storage-connection-string>",
    "FUNCTIONS_WORKER_RUNTIME": "node"
  }
}
```

ğŸ”¹ `AzureWebJobsStorage` â†’ Used by Azure Functions to store logs and output files
ğŸ”¹ `FUNCTIONS_WORKER_RUNTIME` â†’ Specifies Node.js runtime

---

## ğŸ› ï¸ Step 3: Install Required Tools & Dependencies

### 1ï¸âƒ£ Install Azure Functions Core Tools (v4)

**Option: MSI Installer (Recommended for Windows)**

* Go to the Azure Functions Core Tools v4 release page
* Download the **Windows x64 MSI installer**
* Run the installer
* Restart PowerShell
* Verify installation:

```bash
func --version
```

---

### 2ï¸âƒ£ Install Node.js

* Download **Node.js LTS** from the official website
* During installation, select **Add to PATH**
* Restart PowerShell or Git Bash
* Verify installation:

```bash
node -v
npm -v
```

---

### 3ï¸âƒ£ Install Application Dependencies

Inside the function project directory:

```bash
npm install
npm install qrcode
```

ğŸ”¹ `npm install` â†’ Installs project dependencies
ğŸ”¹ `qrcode` â†’ Library used to generate QR codes

---

### 4ï¸âƒ£ Run Function Locally

Start the Azure Function locally:

```bash
func start
```

âœ… If Node.js is installed correctly, the worker runtime will start successfully.

---

## â˜ï¸ Step 4: Publish Function Code to Azure

Deploy the function code to the Azure Function App created by Terraform:

```bash
func azure functionapp publish harish-function-qr --build remote
```

### Why `--build remote`?

* Azure installs `npm` dependencies in the cloud
* Avoids local OS or dependency conflicts

After publishing:

* The function appears in **Azure Portal â†’ Function App â†’ Functions**

---

## ğŸ”„ Post-Deployment Steps

1. Run `npm install` (if not already done)
2. Publish the function code
3. Update application settings (if required)
4. Restart the Function App from Azure Portal

---

## ğŸ§ª Testing the Function

* Use **Postman** to send a GET request to the Function URL
* If response status is **200 OK**, the function executed successfully
* Open the URL returned in the response

ğŸ“Œ The QR code:

* Is generated successfully
* Stored in the Azure Storage Account
* Can be downloaded from the storage container

---

## âœ… Summary

âœ” Terraform automates infrastructure creation
âœ” Azure Functions hosts serverless QR generation logic
âœ” Node.js handles QR code generation
âœ” Azure Storage stores generated QR images

This project is a complete example of **Infrastructure as Code + Serverless deployment on Azure**.

---

Happy Learning ğŸš€
